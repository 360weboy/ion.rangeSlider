// Ion.RangeSlider
// version 1.0.47
// http://ionden.com/a/plugins/ion.rangeSlider/
(function(d){d.fn.ionRangeSlider=function(n){var j=this,c=d.extend({min:parseInt(j.attr("value").split(";")[0])||10,max:parseInt(j.attr("value").split(";")[1])||100,from:parseInt(j.attr("value").split(";")[0])||10,to:parseInt(j.attr("value").split(";")[1])||100,type:"single",step:1,postfix:"",onChange:null},n),m="ion-range-slider-"+parseInt(1E11*Math.random()),h='<span class="irs" id="'+m+'">',h=h+'<span class="irs-line"><span class="irs-line-left"></span><span class="irs-line-mid"></span><span class="irs-line-right"></span></span>',
h=h+'<span class="irs-min">0</span><span class="irs-max">1</span>',h=h+'<span class="irs-from">0</span><span class="irs-to">0</span><span class="irs-single">0</span>',h=h+"</span>",l='<span class="irs-diapazon"></span>',l=l+'<span class="irs-slider from"></span>',l=l+'<span class="irs-slider to"></span>';({init:function(){var a=this;this.allowDrag=!1;this.sliderWidth=this.fullWidth=this.normalWidth=this.mouseX=0;this.numbers={};j[0].style.display="none";j.after(h);this.rangeSlider=d("#"+m);this.fieldMin=
this.rangeSlider.find(".irs-min");this.fieldMax=this.rangeSlider.find(".irs-max");this.fieldMin.html(this.prettify(c.min)+c.postfix);this.fieldMax.html(this.prettify(c.max)+c.postfix);this.fieldMinWidth=this.fieldMin.outerWidth();this.fieldMaxWidth=this.fieldMax.outerWidth();this.fieldFrom=this.rangeSlider.find(".irs-from");this.fieldTo=this.rangeSlider.find(".irs-to");this.fieldSingle=this.rangeSlider.find(".irs-single");"single"==c.type?(this.rangeSlider.append('<span class="irs-slider single"></span>'),
this.singleSlider=this.rangeSlider.find(".single"),this.singleSlider.on("mousedown",function(b){b.preventDefault();b.stopPropagation();a.calcDimentions(b,d(this),null);a.allowDrag=!0;k&&d("*").prop("unselectable",!0)})):"double"==c.type&&(this.rangeSlider.append(l),this.fromSlider=this.rangeSlider.find(".from"),this.toSlider=this.rangeSlider.find(".to"),this.diapazon=this.rangeSlider.find(".irs-diapazon"),this.setDiapazon(),this.fromSlider.on("mousedown",function(b){b.preventDefault();b.stopPropagation();
d(this).addClass("last");a.toSlider.removeClass("last");a.calcDimentions(b,d(this),"from");a.allowDrag=!0;k&&d("*").prop("unselectable",!0)}),this.toSlider.on("mousedown",function(b){b.preventDefault();b.stopPropagation();d(this).addClass("last");a.fromSlider.removeClass("last");a.calcDimentions(b,d(this),"to");a.allowDrag=!0;k&&d("*").prop("unselectable",!0)}));d(document.body).on("mouseup",function(){a.allowDrag&&(a.allowDrag=!1,d("#irs-active-slider").removeAttr("id"),a.activeSlider=null,"double"==
c.type&&a.setDiapazon(),a.getNumbers(),k&&d("*").prop("unselectable",!1))});d(document.body).on("mousemove",function(b){a.allowDrag&&(a.mouseX=b.pageX,a.dragSlider())});this.getSize();this.setNumbers()},getSize:function(){this.normalWidth=this.rangeSlider.width();this.sliderWidth=this.singleSlider?this.singleSlider.width():this.fromSlider.width();this.fullWidth=this.normalWidth-this.sliderWidth},calcDimentions:function(a,b,f){this.getSize();this.activeSlider=b;this.activeSlider.attr("id","irs-active-slider");
b=this.activeSlider.offset().left;this.minusX=b+(a.pageX-b)-this.activeSlider.position().left;"single"==c.type?this.width=this.rangeSlider.width()-this.sliderWidth:"double"==c.type&&("from"==f?(this.left=0,this.right=parseInt(this.toSlider.css("left"))):(this.left=parseInt(this.fromSlider.css("left")),this.right=this.rangeSlider.width()-this.sliderWidth))},dragSlider:function(){var a=Math.round(this.mouseX-this.minusX);"single"==c.type?(0>a&&(a=0),a>this.width&&(a=this.width),this.getNumbers()):"double"==
c.type&&(a<this.left&&(a=this.left),a>this.right&&(a=this.right),this.getNumbers(),this.setDiapazon());this.activeSlider[0].style.left=a+"px"},getNumbers:function(){var a={fromNumber:0,toNumber:0,fromPers:0,toPers:0,fromX:0,toX:0},b=c.max-c.min,f;"single"==c.type?(a.fromX=parseInt(this.singleSlider[0].style.left)||this.singleSlider.position().left,a.fromPers=100*(a.fromX/this.fullWidth),f=b/100*a.fromPers+parseInt(c.min),a.fromNumber=Math.round(f/c.step)*c.step):"double"==c.type&&(a.fromX=parseInt(this.fromSlider[0].style.left)||
this.fromSlider.position().left,a.fromPers=100*(a.fromX/this.fullWidth),f=b/100*a.fromPers+parseInt(c.min),a.fromNumber=Math.round(f/c.step)*c.step,a.toX=parseInt(this.toSlider[0].style.left)||this.toSlider.position().left,a.toPers=100*(a.toX/this.fullWidth),b=b/100*a.toPers+parseInt(c.min),a.toNumber=Math.round(b/c.step)*c.step);this.numbers=a;this.setFileds()},setNumbers:function(){var a={fromNumber:c.from,toNumber:c.to,fromPers:0,toPers:0,fromX:0,toX:0},b=c.max-c.min;"single"==c.type?(a.fromPers=
100*((a.fromNumber-c.min)/b),a.fromX=Math.round(this.fullWidth/100*a.fromPers),this.singleSlider[0].style.left=a.fromX+"px"):"double"==c.type&&(a.fromPers=100*((a.fromNumber-c.min)/b),a.fromX=Math.round(this.fullWidth/100*a.fromPers),this.fromSlider[0].style.left=a.fromX+"px",a.toPers=100*((a.toNumber-c.min)/b),a.toX=Math.round(this.fullWidth/100*a.toPers),this.toSlider[0].style.left=a.toX+"px",this.setDiapazon());this.numbers=a;this.setFileds()},setFileds:function(){var a,b,f,d,g,e;e=this.sliderWidth/
2;"single"==c.type?(this.fieldFrom[0].style.display="none",this.fieldTo[0].style.display="none",f=this.prettify(this.numbers.fromNumber)+c.postfix,this.fieldSingle.html(f),g=this.fieldSingle.outerWidth(),e=this.numbers.fromX-g/2+e,0>e&&(e=0),e>this.normalWidth-g&&(e=this.normalWidth-g),this.fieldSingle[0].style.left=e+"px",this.fieldMin[0].style.display=e<this.fieldMinWidth?"none":"block",this.fieldMax[0].style.display=e+g>this.normalWidth-this.fieldMaxWidth?"none":"block",j.attr("value",this.numbers.fromNumber)):
"double"==c.type&&(a=this.prettify(this.numbers.fromNumber)+c.postfix,b=this.prettify(this.numbers.toNumber)+c.postfix,f=this.numbers.fromNumber!=this.numbers.toNumber?this.prettify(this.numbers.fromNumber)+" \u2014 "+this.prettify(this.numbers.toNumber)+c.postfix:this.prettify(this.numbers.fromNumber)+c.postfix,this.fieldFrom.html(a),this.fieldTo.html(b),this.fieldSingle.html(f),a=this.fieldFrom.outerWidth(),b=this.numbers.fromX-a/2+e,0>b&&(b=0),b>this.normalWidth-a&&(b=this.normalWidth-a),this.fieldFrom[0].style.left=
b+"px",f=this.fieldTo.outerWidth(),d=this.numbers.toX-f/2+e,0>d&&(d=0),d>this.normalWidth-f&&(d=this.normalWidth-f),this.fieldTo[0].style.left=d+"px",g=this.fieldSingle.outerWidth(),e=this.numbers.fromX+(this.numbers.toX-this.numbers.fromX)/2-g/2+e,0>e&&(e=0),e>this.normalWidth-g&&(e=this.normalWidth-g),this.fieldSingle[0].style.left=e+"px",b+a<d?(this.fieldSingle[0].style.display="none",this.fieldFrom[0].style.display="block",this.fieldTo[0].style.display="block"):(this.fieldSingle[0].style.display=
"block",this.fieldFrom[0].style.display="none",this.fieldTo[0].style.display="none"),this.fieldMin[0].style.display=e<this.fieldMinWidth||b<this.fieldMinWidth?"none":"block",this.fieldMax[0].style.display=e+g>this.normalWidth-this.fieldMaxWidth||d+f>this.normalWidth-this.fieldMaxWidth?"none":"block",j.attr("value",this.numbers.fromNumber+";"+this.numbers.toNumber));"function"==typeof c.onChange&&c.onChange.call(this,this.numbers)},setDiapazon:function(){var a=this.fromSlider.width(),b=parseInt(this.fromSlider[0].style.left)||
this.fromSlider.position().left,c=(parseInt(this.toSlider[0].style.left)||this.toSlider.position().left)-b;this.diapazon[0].style.left=b+a/2+"px";this.diapazon[0].style.width=c+"px"},prettify:function(a){return a.toString().replace(/(\d{1,3}(?=(?:\d\d\d)+(?!\d)))/g,"$1 ")}}).init();var k=function(){var a=navigator.userAgent,b=/msie\s\d+/i;return 0<a.search(b)?(a=b.exec(a).toString(),a=a.split(" ")[1],9>a?k=!0:k=!1):k=!1}}})(jQuery);